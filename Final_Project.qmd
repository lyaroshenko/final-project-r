---
title: "–ö–æ–ª–∏ —ñ –¥–µ –≤—É–ª–∏—Ü—ñ –ù—å—é-–ô–æ—Ä–∫–∞ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à—ñ"
subtitle: "–ê–Ω–∞–ª—ñ–∑ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π –±–µ–∑–ø–µ–∫–∏ –¥–æ—Ä–æ–∂–Ω—å–æ–≥–æ —Ä—É—Ö—É –≤ –ù—å—é-–ô–æ—Ä–∫—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–∏—Ö"
author: "Illia Hrynkiv, Liliia Yaroshenko, Mykola Utkin"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: show
    theme: cosmic sans
    fig-width: 14
    fig-height: 12
    embed-resources: true
---

## –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ

–ù—å—é-–ô–æ—Ä–∫ –∑ –π–æ–≥–æ 8,3 –º—ñ–ª—å–π–æ–Ω–∞–º–∏ –∂–∏—Ç–µ–ª—ñ–≤ —ñ –º—ñ–ª—å–π–æ–Ω–∞–º–∏ —â–æ–¥–µ–Ω–Ω–∏—Ö –ø–∞—Å–∞–∂–∏—Ä—ñ–≤ —Å—Ç–∏–∫–∞—î—Ç—å—Å—è –∑ –ø–æ—Å—Ç—ñ–π–Ω–∏–º–∏ –≤–∏–∫–ª–∏–∫–∞–º–∏ —É —Å—Ñ–µ—Ä—ñ –±–µ–∑–ø–µ–∫–∏ –¥–æ—Ä–æ–∂–Ω—å–æ–≥–æ —Ä—É—Ö—É. –¶–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∞–Ω–∞–ª—ñ–∑—É—î **–∫–æ–ª–∏, –¥–µ —ñ —á–æ–º—É** —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è –¥–æ—Ä–æ–∂–Ω—å–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ñ –ø—Ä–∏–≥–æ–¥–∏ —É –ø'—è—Ç–∏ —Ä–∞–π–æ–Ω–∞—Ö –º—ñ—Å—Ç–∞, –ø–æ—î–¥–Ω—É—é—á–∏ –¥–∞–Ω—ñ –ø—Ä–æ –ø–æ—ó–∑–¥–∫–∏ —Ç–∞–∫—Å—ñ –∑ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π –≤–∏—Å–æ–∫–æ–≥–æ —Ä–∏–∑–∏–∫—É.

---

## 1. –í—Å—Ç—É–ø —ñ –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫—ñ –ø–∏—Ç–∞–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞

–î–æ—Ä–æ–∂–Ω—å–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ñ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏ –≤ –ù—å—é-–ô–æ—Ä–∫—É —â–æ—Ä–æ–∫—É –ø—Ä–∏–∑–≤–æ–¥—è—Ç—å –¥–æ —Ç–∏—Å—è—á —Ç—Ä–∞–≤–º —ñ –¥–µ—Å—è—Ç–∫—ñ–≤ —Å–º–µ—Ä—Ç–µ–π. –†–æ–∑—É–º—ñ–Ω–Ω—è **–ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–æ-—á–∞—Å–æ–≤–∏—Ö –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π** —Ü–∏—Ö –∞–≤–∞—Ä—ñ–π —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ç—Ä—É—á–∞–Ω–Ω—è. –û–¥–Ω–∞–∫ –∞–≤–∞—Ä—ñ—ó –Ω–µ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è —ñ–∑–æ–ª—å–æ–≤–∞–Ω–æ ‚Äî –Ω–∞ –Ω–∏—Ö –≤–ø–ª–∏–≤–∞—é—Ç—å –æ–±—Å—è–≥ —Ç—Ä–∞—Ñ—ñ–∫—É, –∑–∞—Ç–æ—Ä–∏, —á–∞—Å –¥–æ–±–∏ —Ç–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤–æ–¥—ñ—ó–≤.

### –ù–∞—à—ñ –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫—ñ –ø–∏—Ç–∞–Ω–Ω—è

–¶–µ–π –ø—Ä–æ—î–∫—Ç –¥–æ—Å–ª—ñ–¥–∂—É—î —Ç—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è:

1. **–ö–æ–ª–∏ –≤—É–ª–∏—Ü—ñ –ù—å—é-–ô–æ—Ä–∫–∞ –Ω–∞–π–±—ñ–ª—å—à –Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ?**  
   - –£ —è–∫—ñ –¥–Ω—ñ —Ç–∞ –≥–æ–¥–∏–Ω–∏ —Å—Ç–∞—î—Ç—å—Å—è –Ω–∞–π–±—ñ–ª—å—à–µ –∞–≤–∞—Ä—ñ–π?
   - –Ø–∫ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ –º—ñ–∂ –±—É–¥–Ω—è–º–∏ —Ç–∞ –≤–∏—Ö—ñ–¥–Ω–∏–º–∏?

2. **–©–æ —Å–ø—Ä–∏—á–∏–Ω—è—î –Ω–∞–π—Å–µ—Ä–π–æ–∑–Ω—ñ—à—ñ –∞–≤–∞—Ä—ñ—ó?**  
   - –Ø–∫–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤–æ–¥—ñ—ó–≤ –∞–±–æ —É–º–æ–≤–∏ –ø—Ä–∏–∑–≤–æ–¥—è—Ç—å –¥–æ —Ç—Ä–∞–≤–º?
   - –ß–∏ —î –ø–µ–≤–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ –±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω–∏–º–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö?

3. **–ß–∏ –∑–±—ñ–ª—å—à—É—é—Ç—å –¥–æ—Ä–æ–∂–Ω—ñ –∑–∞—Ç–æ—Ä–∏ —Ä–∏–∑–∏–∫ –∞–≤–∞—Ä—ñ–π?**  
   - –ß–∏ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ (–ø—Ä–æ–∫—Å—ñ –¥–ª—è –∑–∞—Ç–æ—Ä—ñ–≤) –∫–æ—Ä–µ–ª—é—î –∑ —á–∞—Å—Ç–æ—Ç–æ—é –∞–≤–∞—Ä—ñ–π?
   - –Ø–∫ —Ü—è –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö?

### –ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ

–†–æ–∑—É–º—ñ–Ω–Ω—è —Ü–∏—Ö –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π –¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å:
- **–¶—ñ–ª—å–æ–≤–µ –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è**: —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –ø–æ–ª—ñ—Ü–µ–π—Å—å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É –º—ñ—Å—Ü—è—Ö/—á–∞—Å—ñ –≤–∏—Å–æ–∫–æ–≥–æ —Ä–∏–∑–∏–∫—É
- **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏**: –ø–µ—Ä–µ–ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Ä—ñ–≥ —Ç–∞–º, –¥–µ —Ü–µ –Ω–∞–π–±—ñ–ª—å—à–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ
- **–ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –æ–±—ñ–∑–Ω–∞–Ω–æ—Å—Ç—ñ**: –æ—Å–≤—ñ—Ç–Ω—ñ –∫–∞–º–ø–∞–Ω—ñ—ó, –ø—Ä–∏—É—Ä–æ—á–µ–Ω—ñ –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–ø–ª–∏–≤—É
- **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è**: —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫–æ–º –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–∏—Ö

---

## 2. –î–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö —ñ –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö

–ú–∏ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞–ª–∏ —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É:

#### üìä **–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö 1: –î–∞–Ω—ñ –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ –ù—å—é-–ô–æ—Ä–∫–∞ (—Å—ñ—á–µ–Ω—å-–ª—é—Ç–∏–π 2023)**

**–î–∂–µ—Ä–µ–ª–æ**: NYC Taxi & Limousine Commission  
**–§–æ—Ä–º–∞—Ç**: —Ñ–∞–π–ª–∏ Parquet (–µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ –∫–æ–ª–æ–Ω–∫–æ–≤–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è)  
**–ó–∞–ø–∏—Å—ñ–≤**: +-12 –º—ñ–ª—å–π–æ–Ω—ñ–≤ –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ –∑–∞ –¥–≤–∞ –º—ñ—Å—è—Ü—ñ  
**–ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ**:
- `tpep_pickup_datetime`: —á–∞—Å –ø–æ—á–∞—Ç–∫—É –ø–æ—ó–∑–¥–∫–∏
- `tpep_dropoff_datetime`: —á–∞—Å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–æ—ó–∑–¥–∫–∏
- `PULocationID`: –∫–æ–¥ –∑–æ–Ω–∏ –ø–æ—Å–∞–¥–∫–∏
- `trip_distance`: –≤—ñ–¥—Å—Ç–∞–Ω—å –ø–æ—ó–∑–¥–∫–∏ –≤ –º–∏–ª—è—Ö
- `total_amount`: –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–æ—ó–∑–¥–∫–∏

**–ß–æ–º—É –¥–∞–Ω—ñ —Ç–∞–∫—Å—ñ?** –ü–æ—ó–∑–¥–∫–∏ —Ç–∞–∫—Å—ñ —Å–ª—É–≥—É—é—Ç—å –ø—Ä–æ–∫—Å—ñ –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–∏—Ö –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π —Ä—É—Ö—É —Ç–∞ —Ä—ñ–≤–Ω—è –∑–∞—Ç–æ—Ä—ñ–≤ —É –ù—å—é-–ô–æ—Ä–∫—É. –í–∏—Å–æ–∫–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞–∫—Å—ñ –≤–∫–∞–∑—É—î –Ω–∞ –≤–∏—Å–æ–∫–∏–π –æ–±—Å—è–≥ —Ç—Ä–∞—Ñ—ñ–∫—É, —Ç–æ–¥—ñ —è–∫ –¥–æ–≤—à–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ—ó–∑–¥–æ–∫ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –∑–∞—Ç–æ—Ä–∏.

#### üö® **–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö 2: –î–¢–ü —É –ù—å—é-–ô–æ—Ä–∫—É**

**–î–∂–µ—Ä–µ–ª–æ**: NYC Open Data (–∑–≤—ñ—Ç–∏ NYPD –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó)  
**–§–æ—Ä–º–∞—Ç**: CSV —á–µ—Ä–µ–∑ API  
**–ó–∞–ø–∏—Å—ñ–≤**: 2+ –º—ñ–ª—å–π–æ–Ω–∏ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó  
**–ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ**:
- `crash_date`, `crash_time`: –∫–æ–ª–∏ —Å—Ç–∞–ª–∞—Å—è –∞–≤–∞—Ä—ñ—è
- `borough`: –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω, –ë—Ä—É–∫–ª—ñ–Ω, –ö–≤—ñ–Ω–∑, –ë—Ä–æ–Ω–∫—Å, –°—Ç–µ–π—Ç–µ–Ω-–ê–π–ª–µ–Ω–¥
- `latitude`, `longitude`: —Ç–æ—á–Ω–µ –º—ñ—Å—Ü–µ –∞–≤–∞—Ä—ñ—ó
- `contributing_factor_vehicle_1`: –æ—Å–Ω–æ–≤–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ (–ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤–æ–¥—ñ—è, —É–º–æ–≤–∏)
- `number_of_persons_injured/killed`: –º–µ—Ç—Ä–∏–∫–∏ —Ç—è–∂–∫–æ—Å—Ç—ñ

**–î–∏—Å–∫–ª–µ–π–º–µ—Ä:** –¥–∞–Ω—ñ –º–∞—é—Ç—å –¥–µ—è–∫—É –Ω–µ—Ç–æ—á–Ω—ñ—Å—Ç—å –≤ —Ä–æ–∑—É–º—ñ–Ω–Ω—ñ —á–∞—Å–æ–≤–æ—ó –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ - –¥–∞–Ω—ñ –ø—Ä–æ —Ç–∞–∫—Å—ñ –∑–∞ 2023 —Ä—ñ–∫, –∞ –¥–∞–Ω—ñ –ø–æ –∞–≤–∞—Ä—ñ—è–º –∑–∞ 2025 —Ä—ñ–∫. 

**–ß–æ–º—É –¥–∞–Ω—ñ –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó?** –û—Ñ—ñ—Ü—ñ–π–Ω—ñ –ø–æ–ª—ñ—Ü–µ–π—Å—å–∫—ñ –∑–≤—ñ—Ç–∏ –Ω–∞–¥–∞—é—Ç—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ñ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ —Ç–µ, –∫–æ–ª–∏, –¥–µ —ñ —á–æ–º—É –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è –∞–≤–∞—Ä—ñ—ó, –≤–∫–ª—é—á–∞—é—á–∏ —Ç—è–∂–∫—ñ—Å—Ç—å —ñ –ø—Ä–∏—á–∏–Ω–∏.

#### **–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö 3: –ú–µ–∂—ñ —Ç–∞–∫—Å—ñ-–∑–æ–Ω –ù—å—é-–ô–æ—Ä–∫–∞**

**–î–∂–µ—Ä–µ–ª–æ**: NYC TLC  
**–§–æ—Ä–º–∞—Ç**: GeoJSON (–ø—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ –¥–∞–Ω—ñ)  
**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î –∫–æ–¥–∏ –ª–æ–∫–∞—Ü—ñ–π —Ç–∞–∫—Å—ñ –∑ —Ä–∞–π–æ–Ω–∞–º–∏ —Ç–∞ –±–æ—Ä–æ  
**–ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ**:
- `locationid`: —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∑–æ–Ω–∏
- `zone`: –Ω–∞–∑–≤–∞ —Ä–∞–π–æ–Ω—É
- `borough`: –Ω–∞–∑–≤–∞ –±–æ—Ä–æ
- `geometry`: –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ –º–µ–∂—ñ

**–ß–æ–º—É –¥–∞–Ω—ñ –ø—Ä–æ –∑–æ–Ω–∏?** –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î —á–∏—Å–ª–æ–≤—ñ –∫–æ–¥–∏ –ª–æ–∫–∞—Ü—ñ–π —É –∑—Ä–æ–∑—É–º—ñ–ª—ñ –Ω–∞–∑–≤–∏ —Ä–∞–π–æ–Ω—ñ–≤, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ —ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è.

---

### –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥

#### –ß–æ–º—É DuckDB?

–ú–∏ –æ–±—Ä–∞–ª–∏ **DuckDB** —è–∫ –Ω–∞—à –æ—Å–Ω–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π –¥–≤–∏–≥—É–Ω, —Ç–æ–º—É —â–æ:

‚úÖ **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö**: –æ–±—Ä–æ–±–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö –±–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –ø–∞–º'—è—Ç—å R  
‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Parquet**: –Ω–∞—Ç–∏–≤–Ω–µ —á–∏—Ç–∞–Ω–Ω—è –∫–æ–ª–æ–Ω–∫–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É (—É –±–∞–≥–∞—Ç–æ —à–≤–∏–¥—à–µ –∑–∞ CSV)  
‚úÖ **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è SQL**: —Å–∫–ª–∞–¥–Ω—ñ –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –∑—ñ –∑–Ω–∞–π–æ–º–∏–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**: –≤–±—É–¥–æ–≤–∞–Ω—ñ –≥–µ–æ–ø—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ª–æ–∫–∞—Ü—ñ–π  
‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HTTP**: –ø—Ä—è–º–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ URL –±–µ–∑ —Å–∫–∞—á—É–≤–∞–Ω–Ω—è

#### –ü–æ—Ä—è–¥–æ–∫ –¥—ñ–π

```
–°–∏—Ä—ñ –¥–∞–Ω—ñ ‚Üí –¢–∞–±–ª–∏—Ü—ñ DuckDB ‚Üí SQL-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó ‚Üí –ê–Ω–∞–ª—ñ–∑ —É R ‚Üí –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
```

–ù–∞—à —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å:
1. **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** —Ñ–∞–π–ª—ñ–≤ Parquet —Ç–∞–∫—Å—ñ —Ç–∞ CSV –∞–≤–∞—Ä—ñ–π —É DuckDB
2. **–ü–∞—Ä—Å–∏–Ω–≥** GeoJSON –¥–ª—è –≤–∏—Ç—è–≥—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π –∑–æ–Ω–∞-–±–æ—Ä–æ
3. **–û–±'—î–¥–Ω–∞–Ω–Ω—è** –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ –∑ –¥–∞–Ω–∏–º–∏ –∑–æ–Ω –¥–ª—è –∑–±–∞–≥–∞—á–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –ª–æ–∫–∞—Ü—ñ—é
4. **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è** –∑–∞ —á–∞—Å–æ–≤–∏–º–∏ –ø–µ—Ä—ñ–æ–¥–∞–º–∏ (–≥–æ–¥–∏–Ω–∞, –¥–µ–Ω—å) —Ç–∞ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—î—é (–±–æ—Ä–æ)
5. **–ó–ª–∏—Ç—Ç—è** –¥–∞–Ω–∏—Ö —Ç–∞–∫—Å—ñ —Ç–∞ –∞–≤–∞—Ä—ñ–π –∑–∞ —á–∞—Å–æ–≤–∏–º–∏ —Ç–∞ –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–∏–º–∏ –≤–∏–º—ñ—Ä–∞–º–∏
6. **–ê–Ω–∞–ª—ñ–∑** –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π —ñ –∫–æ—Ä–µ–ª—è—Ü—ñ–π
7. **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è** –≤–∏—Å–Ω–æ–≤–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ggplot2

---

## 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

```{r setup-packages}
#| message: false
#| warning: false

library(duckdb)      # –®–≤–∏–¥–∫–∞ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
library(dplyr)       # –ú–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—è –¥–∞–Ω–∏–º–∏
library(tidyr)       # –£–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
library(ggplot2)     # –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
library(lubridate)   # –†–æ–±–æ—Ç–∞ –∑ –¥–∞—Ç–∞–º–∏/—á–∞—Å–æ–º
library(scales)      # –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
library(sf)          # –ü—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ –¥–∞–Ω—ñ
library(viridis)     # –ö–æ–ª—ñ—Ä–Ω—ñ –ø–∞–ª—ñ—Ç—Ä–∏
library(patchwork)   # –û–±'—î–¥–Ω–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤

# –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ DuckDB
con <- dbConnect(duckdb::duckdb())
cat("–ó'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
```

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω—å —ñ –¥–∞–Ω–∏—Ö

```{r load-data}
#| message: false
#| warning: false

# –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ HTTP –¥–ª—è –ø—Ä—è–º–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ URL
invisible(dbExecute(con, "INSTALL httpfs; LOAD httpfs; SET enable_http_metadata_cache=true;"))

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–∫—Å—ñ –∑ –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ Parquet
invisible(dbExecute(con, "
  CREATE TABLE taxi_jan AS 
  SELECT * FROM read_parquet('D://RProjects//r4ds-2025//Final_Project//final-project-r//data//taxi_trip_data_jan_2023.parquet')
"))

invisible(dbExecute(con, "
  CREATE TABLE taxi_feb AS 
  SELECT * FROM read_parquet('D://RProjects//r4ds-2025//Final_Project//final-project-r//data//taxi_trip_data_feb_2023.parquet')
"))

# –û–±'—î–¥–Ω–∞–Ω–Ω—è –º—ñ—Å—è—Ü—ñ–≤ –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—é
invisible(dbExecute(con, "
  CREATE TABLE taxi_all AS 
  SELECT * FROM taxi_jan 
  UNION ALL 
  SELECT * FROM taxi_feb
"))

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è JSON –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥—É GeoJSON
invisible(dbExecute(con, "INSTALL json; LOAD json;"))

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–µ–∂ —Ç–∞–∫—Å—ñ-–∑–æ–Ω
invisible(dbExecute(con, "
  CREATE TABLE taxi_zones AS 
  SELECT * FROM read_json_auto('D://RProjects//r4ds-2025//Final_Project//final-project-r//data//taxi_zones.geojson')
"))

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ NYC Open Data API
invisible(dbExecute(con, "
  CREATE TABLE crash_data AS 
  SELECT * FROM read_csv_auto('https://data.cityofnewyork.us/resource/h9gi-nx95.csv')
"))

cat("–í—Å—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
```

### –ü–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö

#### –í–∏—Ç—è–≥–Ω–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –±–æ—Ä–æ –∑ GeoJSON

GeoJSON —Ç–∞–∫—Å—ñ-–∑–æ–Ω —î –≤–∫–ª–∞–¥–µ–Ω–∏–º ‚Äî –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤–∏—Ç—è–≥—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π –±–æ—Ä–æ:

```{r flatten-zones}
invisible(dbExecute(con, "
  CREATE TABLE flattened_zones AS
  SELECT 
    f.value.properties.locationid::INT AS location_id,
    f.value.properties.zone AS zone,
    f.value.properties.borough AS borough
  FROM taxi_zones,
  UNNEST(taxi_zones.features) AS f(value)
"))

dbGetQuery(con, "SELECT * FROM flattened_zones LIMIT 5") |>
  knitr::kable(caption = "–ó—Ä–∞–∑–æ–∫ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ –∑–æ–Ω–∏")
```

**–©–æ —Ü–µ —Ä–æ–±–∏—Ç—å:**
- `UNNEST`: —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –≤–∫–ª–∞–¥–µ–Ω–∏–π JSON-–º–∞—Å–∏–≤ —É —Ä—è–¥–∫–∏
- `f.value.properties.*`: –¥–æ—Å—Ç—É–ø –¥–æ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π
- `::INT`: –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è ID –ª–æ–∫–∞—Ü—ñ—ó –¥–æ —Ü—ñ–ª–æ–≥–æ —á–∏—Å–ª–∞ –¥–ª—è –æ–±'—î–¥–Ω–∞–Ω–Ω—è

#### –ó–±–∞–≥–∞—á–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–∫—Å—ñ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é

```{r enrich-taxi}

invisible(dbExecute(con, "
  CREATE TABLE taxi_enriched AS
  SELECT 
    t.*, 
    z.zone AS pickup_zone, 
    z.borough AS pickup_borough
  FROM taxi_all t
  LEFT JOIN flattened_zones z
    ON t.PULocationID = z.location_id
"))

enrichment_stats <- dbGetQuery(con, "
  SELECT 
    COUNT(*) AS total_trips,
    COUNT(pickup_borough) AS trips_with_borough,
    ROUND(COUNT(pickup_borough) * 100.0 / COUNT(*), 2) AS pct_matched
  FROM taxi_enriched
")

cat(sprintf("–ó–±–∞–≥–∞—á–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ: %.1f%% –ø–æ—ó–∑–¥–æ–∫ –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–æ", 
            enrichment_stats$pct_matched))
```

**–ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ:** –¢–µ–ø–µ—Ä –∫–æ–∂–Ω–∞ –ø–æ—ó–∑–¥–∫–∞ —Ç–∞–∫—Å—ñ –∑–Ω–∞—î, –∑ —è–∫–æ–≥–æ –±–æ—Ä–æ —Ç–∞ —Ä–∞–π–æ–Ω—É –≤–æ–Ω–∞ –ø–æ—á–∞–ª–∞—Å—è, —â–æ –¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É.

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —è–∫–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö

```{r data-quality}

crash_summary <- dbGetQuery(con, "
  SELECT 
    COUNT(*) AS total_crashes,
    COUNT(DISTINCT borough) AS boroughs_covered,
    MIN(crash_date) AS earliest_crash,
    MAX(crash_date) AS latest_crash,
    SUM(number_of_persons_injured) AS total_injured,
    SUM(number_of_persons_killed) AS total_killed
  FROM crash_data
  WHERE crash_date IS NOT NULL
")

knitr::kable(crash_summary, 
             format.args = list(big.mark = ","),
             caption = "–ó–≤–µ–¥–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–∏—Ö –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó")
```

---

## 4. –ê–Ω–∞–ª—ñ–∑ 1: –ß–∞—Å–æ–≤—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ ‚Äî –∫–æ–ª–∏ –≤—É–ª–∏—Ü—ñ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à—ñ?

### –ü–æ–≥–æ–¥–∏–Ω–Ω—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ –ø–æ—ó–∑–¥–æ–∫ –∑–∞ –±–æ—Ä–æ

–°–ø–æ—á–∞—Ç–∫—É –¥–∞–≤–∞–π—Ç–µ –∑—Ä–æ–∑—É–º—ñ—î–º–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ —Ä—É—Ö—É —á–µ—Ä–µ–∑ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞–∫—Å—ñ:

```{r trips-by-hour}
#| fig-width: 14
#| fig-height: 10

trips_by_hour_borough <- dbGetQuery(con, "
  SELECT 
    HOUR(tpep_pickup_datetime) AS pickup_hour,
    pickup_borough,
    COUNT(*) AS trip_count
  FROM taxi_enriched
  WHERE 
    trip_distance > 0 
    AND trip_distance < 100
    AND total_amount > 0 
    AND total_amount < 500 
    AND pickup_borough IN ('Manhattan', 'Brooklyn', 'Queens', 'Bronx')
  GROUP BY pickup_hour, pickup_borough
")

ggplot(trips_by_hour_borough, aes(x = pickup_hour, y = trip_count, color = pickup_borough)) +
  geom_line(linewidth = 1.5, alpha = 0.8) +
  geom_point(size = 3) +
  geom_area(aes(fill = pickup_borough), alpha = 0.2, position = "identity") +
  scale_x_continuous(
    breaks = seq(0, 23, by = 3),
    labels = paste0(seq(0, 23, by = 3), ":00"),
    name = "–ì–æ–¥–∏–Ω–∞ –¥–æ–±–∏"
  ) +
  scale_y_continuous(
    name = "–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—ó–∑–¥–æ–∫",
    labels = label_comma()
  ) +
  scale_color_viridis_d(option = "plasma", end = 0.9) +
  scale_fill_viridis_d(option = "plasma", end = 0.9) +
  facet_wrap(~ pickup_borough, scales = "free_y", ncol = 2) +
  labs(
    title = "–©–æ–¥–µ–Ω–Ω–∏–π —Ä–∏—Ç–º —Ä—É—Ö—É –≤ –ù—å—é-–ô–æ—Ä–∫—É: –ø–æ—ó–∑–¥–∫–∏ —Ç–∞–∫—Å—ñ –∑–∞ –≥–æ–¥–∏–Ω–æ—é —Ç–∞ –±–æ—Ä–æ",
    subtitle = "–ß—ñ—Ç–∫—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ –ø–∞—Å–∞–∂–∏—Ä–æ–ø–æ—Ç–æ–∫—É –∑ –≤–µ—á—ñ—Ä–Ω—ñ–º–∏ –ø—ñ–∫–∞–º–∏ | –°—ñ—á–µ–Ω—å-–ª—é—Ç–∏–π 2023",
    caption = "–î–∞–Ω—ñ: NYC TLC | –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –¥–ª—è –¥—ñ–π—Å–Ω–∏—Ö –ø–æ—ó–∑–¥–æ–∫ (–≤—ñ–¥—Å—Ç–∞–Ω—å 0-100 –º–∏–ª—å, —Ç–∞—Ä–∏—Ñ 0-$500)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 13, color = "gray30"),
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 14),
    panel.grid.minor = element_blank()
  )
```

**–ö–ª—é—á–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:**

- **–ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω –¥–æ–º—ñ–Ω—É—î**: —É 4-5 —Ä–∞–∑—ñ–≤ –±—ñ–ª—å—à–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞–∫—Å—ñ, –Ω—ñ–∂ –≤ —ñ–Ω—à–∏—Ö –±–æ—Ä–æ
- **–ë—ñ–º–æ–¥–∞–ª—å–Ω–∞ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω—ñ—Å—Ç—å**: —Ä–∞–Ω–∫–æ–≤–∏–π –ø—ñ–∫ (8-9 —Ä–∞–Ω–∫—É) —Ç–∞ –≤–µ—á—ñ—Ä–Ω—ñ–π –ø—ñ–∫ (18-20 –≥–æ–¥–∏–Ω)
- **–ù—ñ—á–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –∑–∞–π–Ω—è—Ç–∏–º –¥–æ 2 –Ω–æ—á—ñ (–Ω—ñ—á–Ω–µ –∂–∏—Ç—Ç—è, —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∏)
- **–ë—Ä—É–∫–ª—ñ–Ω —ñ –ö–≤—ñ–Ω–∑**: —Å—Ö–æ–∂—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ, –∞–ª–µ –Ω–∏–∂—á—ñ –æ–±—Å—è–≥–∏

### –¢–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞ –∞–≤–∞—Ä—ñ–π: –î–µ–Ω—å —Ç–∏–∂–Ω—è —Ö –ì–æ–¥–∏–Ω–∞ –¥–æ–±–∏

–¢–µ–ø–µ—Ä –ø–æ–¥–∏–≤–∏–º–æ—Å—è, –∫–æ–ª–∏ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è –∞–≤–∞—Ä—ñ—ó:

```{r crash-heatmap}
#| fig-width: 14
#| fig-height: 9

crashes_heatmap_data <- dbGetQuery(con, "
  SELECT 
    DAYNAME(crash_date) AS day_of_week,
    HOUR(crash_time) AS hour_of_day,
    COUNT(*) AS crash_count
  FROM crash_data
  WHERE crash_date IS NOT NULL AND crash_time IS NOT NULL
  GROUP BY 1, 2
")

day_levels <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")

crashes_heatmap_data <- crashes_heatmap_data |>
  mutate(
    day_of_week = factor(day_of_week, levels = day_levels)
  )

ggplot(crashes_heatmap_data, aes(x = hour_of_day, y = day_of_week, fill = crash_count)) +
  geom_tile(color = "white", linewidth = 0.8) +
  geom_text(
    aes(label = scales::comma(crash_count, accuracy = 1)),
    size = 3.5,
    color = "white",
    fontface = "bold"
  ) +
  scale_fill_gradient(
    low = "#FFF5E1", 
    high = "#8B0000",
    name = "–ö—ñ–ª—å–∫—ñ—Å—Ç—å–∞–≤–∞—Ä—ñ–π",
    labels = label_comma()
  ) +
  scale_x_continuous(
    breaks = seq(0, 23, by = 2),
    labels = paste0(seq(0, 23, by = 2), ":00"),
    name = "–ì–æ–¥–∏–Ω–∞ –¥–æ–±–∏"
  ) +
  scale_y_discrete(name = NULL) +
  labs(
    title = "–ö–æ–ª–∏ –≤—É–ª–∏—Ü—ñ –ù—å—é-–ô–æ—Ä–∫–∞ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à—ñ: —Ç–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—ó –∞–≤–∞—Ä—ñ–π",
    subtitle = "–ü'—è—Ç–Ω–∏—Ü—è-—Å—É–±–æ—Ç–∞ –≤–≤–µ—á–µ—Ä—ñ (17-20 –≥–æ–¥) –ø–æ–∫–∞–∑—É—é—Ç—å –ø—ñ–∫–∏ –∞–≤–∞—Ä—ñ–π–Ω–æ—Å—Ç—ñ | –¢–µ–º–Ω—ñ—à–µ = –±—ñ–ª—å—à–µ –∞–≤–∞—Ä—ñ–π",
    caption = "–î–∞–Ω—ñ: NYC Open Data (NYPD Motor Vehicle Collisions)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 13, color = "gray30"),
    legend.position = "right",
    panel.grid = element_blank(),
    axis.text.y = element_text(size = 12, face = "bold"),
    axis.text.x = element_text(size = 11)
  ) +
  annotate(
    "rect",
    xmin = 16.5, xmax = 19.5,
    ymin = 4.5, ymax = 6.5,
    alpha = 0.3,
    color = "yellow",
    fill = NA,
    linewidth = 1.5
  ) +
  annotate(
    "text",
    x = 18, y = 7.3,
    label = "–ó–æ–Ω–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–æ—ó –Ω–µ–±–µ–∑–ø–µ–∫–∏",
    size = 5,
    fontface = "bold",
    color = "darkred"
  )
```

**–ö—Ä–∏—Ç–∏—á–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:**

- **–ü–µ—Ä—ñ–æ–¥ –ø—ñ–¥–≤–∏—â–µ–Ω–æ—ó –Ω–µ–±–µ–∑–ø–µ–∫–∏**: –ø'—è—Ç–Ω–∏—Ü—è 17-20 –≥–æ–¥–∏–Ω (–≤–µ—á—ñ—Ä–Ω—ñ–π —á–∞—Å + –ø–æ—á–∞—Ç–æ–∫ –≤–∏—Ö—ñ–¥–Ω–∏—Ö)
- **–ó–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω—ñ—Å—Ç—å –≤–∏—Ö—ñ–¥–Ω–∏—Ö**: —Å—É–±–æ—Ç–∞ –≤–≤–µ—á–µ—Ä—ñ —Ç–∞–∫–æ–∂ –ø–æ–∫–∞–∑—É—î –≤–∏—Å–æ–∫—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞–≤–∞—Ä—ñ–π
- **–†–∞–Ω–∫–æ–≤–∏–π —á–∞—Å**: –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–æ –Ω–∏–∂—á—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞–≤–∞—Ä—ñ–π, –Ω—ñ–∂ –≤–≤–µ—á–µ—Ä—ñ
- **–ü—ñ–∑–Ω—è –Ω—ñ—á**: 2-5 —Ä–∞–Ω–∫—É –ø–æ–∫–∞–∑—É—î –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –∞–≤–∞—Ä—ñ–π —É –≤–∏—Ö—ñ–¥–Ω—ñ (–π–º–æ–≤—ñ—Ä–Ω–æ, –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –∞–ª–∫–æ–≥–æ–ª–µ–º)

**–ü–æ–ª—ñ—Ç–∏—á–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏:** –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –¥–æ—Ä–æ–∂–Ω—å–æ–≥–æ –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è —É –ø'—è—Ç–Ω–∏—Ü—é-—Å—É–±–æ—Ç—É –≤–≤–µ—á–µ—Ä—ñ –≤ –∑–æ–Ω–∞—Ö –≤–∏—Å–æ–∫–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É.

---

## 5. –ê–Ω–∞–ª—ñ–∑ 2: –ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ ‚Äî –¥–µ —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è –∞–≤–∞—Ä—ñ—ó

### –ê–≤–∞—Ä—ñ—ó –∑–∞ –±–æ—Ä–æ

```{r crashes-by-borough}
#| fig-width: 14
#| fig-height: 8

crashes_by_borough <- dbGetQuery(con, "
  SELECT 
    borough,
    COUNT(*) AS crash_count,
    SUM(number_of_persons_injured) AS total_injured,
    SUM(number_of_persons_killed) AS total_killed
  FROM crash_data
  WHERE borough IS NOT NULL
  GROUP BY 1
  ORDER BY 2 DESC
")

crashes_by_borough <- crashes_by_borough |>
  mutate(
    injury_rate = (total_injured / crash_count) * 100,
    fatality_rate = (total_killed / crash_count) * 100
  )


p1 <- ggplot(crashes_by_borough, aes(x = reorder(borough, -crash_count), y = crash_count)) +
  geom_col(aes(fill = crash_count), width = 0.7, alpha = 0.9) +
  geom_text(
    aes(label = paste0(scales::comma(crash_count), "–∞–≤–∞—Ä—ñ–π")),
    vjust = -0.3,
    size = 4.5,
    fontface = "bold"
  ) +
  scale_fill_gradient(low = "#FFA500", high = "#8B0000", guide = "none") +
  scale_y_continuous(
    name = "–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–≤–∞—Ä—ñ–π",
    labels = label_comma(),
    expansion(mult = c(0, 0.15))
  ) +
  scale_x_discrete(name = NULL) +
  labs(
    title = "üó∫Ô∏è –†–æ–∑–ø–æ–¥—ñ–ª –∞–≤–∞—Ä—ñ–π –ø–æ –±–æ—Ä–æ –ù—å—é-–ô–æ—Ä–∫–∞",
    subtitle = "–ë—Ä—É–∫–ª—ñ–Ω –ª—ñ–¥–∏—Ä—É—î –∑–∞ –∑–∞–≥–∞–ª—å–Ω–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∞–≤–∞—Ä—ñ–π, –∞–ª–µ —Ç—è–∂–∫—ñ—Å—Ç—å –≤–∞—Ä—ñ—é—î—Ç—å—Å—è –∑–∞ –±–æ—Ä–æ"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 13, color = "gray30"),
    axis.text.x = element_text(size = 13, face = "bold"),
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank()
  )

p2 <- ggplot(crashes_by_borough, aes(x = reorder(borough, -injury_rate), y = injury_rate)) +
  geom_col(fill = "#D62828", width = 0.7, alpha = 0.8) +
  geom_text(
    aes(label = paste0(round(injury_rate, 1), "%")),
    vjust = -0.5,
    size = 4,
    fontface = "bold"
  ) +
  scale_y_continuous(
    name = "–†—ñ–≤–µ–Ω—å —Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º—É (% –∞–≤–∞—Ä—ñ–π)",
    labels = label_percent(scale = 1),
    expand = expansion(mult = c(0, 0.15))
  ) +
  scale_x_discrete(name = NULL) +
  labs(
    title = "–†—ñ–≤–µ–Ω—å —Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º—É –∑–∞ –±–æ—Ä–æ",
    subtitle = "–í—ñ–¥—Å–æ—Ç–æ–∫ –∞–≤–∞—Ä—ñ–π, —â–æ –ø—Ä–∏–∑–≤–µ–ª–∏ –¥–æ —Ç—Ä–∞–≤–º"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(size = 11, angle = 20, hjust = 1),
    panel.grid.major.x = element_blank()
  )

p1 / p2 + plot_layout(heights = c(2, 1))
```

**–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:**

- **–ë—Ä—É–∫–ª—ñ–Ω**: –Ω–∞–π–≤–∏—â–∞ –∞–±—Å–æ–ª—é—Ç–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–≤–∞—Ä—ñ–π (~450K)
- **–ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω**: –¥—Ä—É–≥–∏–π –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∞–≤–∞—Ä—ñ–π, –∞–ª–µ –Ω–∞–π–≤–∏—â–∞ —â—ñ–ª—å–Ω—ñ—Å—Ç—å —Ç—Ä–∞—Ñ—ñ–∫—É
- **–†—ñ–≤–Ω—ñ —Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º—É**: –≤—ñ–¥–Ω–æ—Å–Ω–æ –ø–æ—Å—Ç—ñ–π–Ω—ñ –ø–æ –±–æ—Ä–æ (25-28%)
- **–°—Ç–µ–π—Ç–µ–Ω-–ê–π–ª–µ–Ω–¥**: –Ω–∞–π–º–µ–Ω—à–µ –∞–≤–∞—Ä—ñ–π, –∞–ª–µ –ø–æ–¥—ñ–±–Ω–∏–π —Ä—ñ–≤–µ–Ω—å —Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º—É (—á–µ—Ä–µ–∑ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –≤ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ñ?)

---

## 6. –ê–Ω–∞–ª—ñ–∑ 3: –û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏ ‚Äî —á–æ–º—É —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è –∞–≤–∞—Ä—ñ—ó

### –¢–æ–ø-–ø—Ä–∏—á–∏–Ω–∏ –∞–≤–∞—Ä—ñ–π –∑ —Ç—Ä–∞–≤–º–∞–º–∏

```{r top-causes}
#| fig-width: 14
#| fig-height: 10

top_causes_data <- dbGetQuery(con, "
  SELECT 
    contributing_factor_vehicle_1 AS cause,
    COUNT(*) AS crash_count,
    SUM(number_of_persons_injured) AS total_injured,
    SUM(number_of_persons_killed) AS total_killed,
    SUM(number_of_persons_injured + number_of_persons_killed) AS total_victims
  FROM crash_data
  WHERE 
    cause IS NOT NULL 
    AND cause != 'Unspecified'
    AND (number_of_persons_injured > 0 OR number_of_persons_killed > 0)
  GROUP BY 1
  ORDER BY 5 DESC
  LIMIT 12
")


top_causes_data <- top_causes_data |>
  mutate(
    cause_wrapped = stringr::str_wrap(cause, width = 40)
  )

ggplot(top_causes_data, aes(x = total_victims, y = reorder(cause_wrapped, total_victims))) +
  geom_col(aes(fill = total_victims), width = 0.75) +
  geom_text(
    aes(label = paste0(scales::comma(total_victims), " –ø–æ—Å—Ç—Ä–∞–∂–¥–∞–ª–∏—Ö",
                      scales::comma(crash_count), " –∞–≤–∞—Ä—ñ–π")),
    hjust = -0.05,
    size = 3.8,
    fontface = "bold"
  ) +
  scale_fill_gradient(
    low = "#FFA07A",
    high = "#8B0000",
    name = "–í—Å—å–æ–≥–æ–ø–æ—Å—Ç—Ä–∞–∂–¥–∞–ª–∏—Ö",
    labels = label_comma()
  ) +
  scale_x_continuous(
    name = "–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Å—Ç—Ä–∞–∂–¥–∞–ª–∏—Ö (—Ç—Ä–∞–≤–º–æ–≤–∞–Ω–∏—Ö + –∑–∞–≥–∏–±–ª–∏—Ö)",
    labels = label_comma(),
    expand = expansion(mult = c(0, 0.2))
  ) +
  scale_y_discrete(name = NULL) +
  labs(
    title = "–¢–æ–ø-–ø—Ä–∏—á–∏–Ω–∏ –∞–≤–∞—Ä—ñ–π –∑ —Ç—Ä–∞–≤–º–∞–º–∏ –≤ –ù—å—é-–ô–æ—Ä–∫—É",
    subtitle = "–ù–µ—É–≤–∞–∂–Ω—ñ—Å—Ç—å/–≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è –≤–æ–¥—ñ—ó–≤ –¥–æ–º—ñ–Ω—É—î, –¥–∞–ª—ñ ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—Ä–æ—ó–∑–¥ —Ç–∞ –∑–∞–Ω–∞–¥—Ç–æ –±–ª–∏–∑—å–∫–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å",
    caption = "–î–∞–Ω—ñ: NYC Open Data | –í–∫–ª—é—á–∞—î –ª–∏—à–µ –∞–≤–∞—Ä—ñ—ó –∑ —Ç—Ä–∞–≤–º–∞–º–∏ –∞–±–æ —Å–º–µ—Ä—Ç–µ–ª—å–Ω–∏–º–∏ –≤–∏–ø–∞–¥–∫–∞–º–∏"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 13, color = "gray30"),
    legend.position = "right",
    axis.text.y = element_text(size = 11),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```

**–ö—Ä–∏—Ç–∏—á–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:**

1. **–ù–µ—É–≤–∞–∂–Ω—ñ—Å—Ç—å/–≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è –≤–æ–¥—ñ—è** (30% –∞–≤–∞—Ä—ñ–π –∑ —Ç—Ä–∞–≤–º–∞–º–∏)
   - –ö–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º, —ó–∂–∞, –ø–∞—Å–∞–∂–∏—Ä–∏ —Ç–æ—â–æ
   - **–†—ñ—à–µ–Ω–Ω—è**: —Å—É–≤–æ—Ä—ñ—à–µ –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è —Ç–∞ –∫–∞–º–ø–∞–Ω—ñ—ó –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –æ–±—ñ–∑–Ω–∞–Ω–æ—Å—Ç—ñ

2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—Ä–æ—ó–∑–¥ –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—å** (2-–≥–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∞ –ø—Ä–∏—á–∏–Ω–∞)
   - –ü—Ä–æ–±–ª–µ–º–∏ –¥–∏–∑–∞–π–Ω—É –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—å
   - **–†—ñ—à–µ–Ω–Ω—è**: –ø–æ–∫—Ä–∞—â–µ–Ω—ñ –∑–Ω–∞–∫–∏, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–≤—ñ—Ç–ª–æ—Ñ–æ—Ä—ñ–≤, —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø—ñ—à–æ—Ö–æ–¥—ñ–≤

3. **–ó–∞–Ω–∞–¥—Ç–æ –±–ª–∏–∑—å–∫–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å** (—ó–∑–¥–∞ –≤–ø—Ä–∏—Ç—É–ª)
   - –ü–æ–≤–µ–¥—ñ–Ω–∫–∞, –ø–æ–≤'—è–∑–∞–Ω–∞ —ñ–∑ –∑–∞—Ç–æ—Ä–∞–º–∏
   - **–†—ñ—à–µ–Ω–Ω—è**: –∑–º—ñ–Ω–Ω—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ –∑–Ω–∞–∫–∏ –∑ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è–º–∏ –ø—Ä–æ –±–µ–∑–ø–µ—á–Ω—É –≤—ñ–¥—Å—Ç–∞–Ω—å

4. **–ù–µ–±–µ–∑–ø–µ—á–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å** (4-—Ç–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∞)
   - –ü–æ—Ä—É—à–µ–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ
   - **–†—ñ—à–µ–Ω–Ω—è**: –∫–∞–º–µ—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é —à–≤–∏–¥–∫–æ—Å—Ç—ñ, –∑–∞—Ö–æ–¥–∏ –¥–ª—è –∑–∞—Å–ø–æ–∫–æ—î–Ω–Ω—è —Ä—É—Ö—É

---

## 7. –ê–Ω–∞–ª—ñ–∑ 4: –ó–≤'—è–∑–æ–∫ –∑–∞—Ç–æ—Ä–∏-–∞–≤–∞—Ä—ñ—ó

### –ß–∏ –∑–±—ñ–ª—å—à—É—é—Ç—å –¥–æ—Ä–æ–∂–Ω—ñ –∑–∞—Ç–æ—Ä–∏ —Ä–∏–∑–∏–∫ –∞–≤–∞—Ä—ñ–π?

–ú–∏ –≤–∏—Å—É–≤–∞—î–º–æ –≥—ñ–ø–æ—Ç–µ–∑—É, —â–æ –∑–∞—Ç–æ—Ä–∏ (–≤–∏–º—ñ—Ä—é–≤–∞–Ω—ñ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ) –∫–æ—Ä–µ–ª—é—é—Ç—å –∑ —á–∞—Å—Ç–æ—Ç–æ—é –∞–≤–∞—Ä—ñ–π. –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —Ü–µ:

```{r congestion-crash-analysis}
#| message: false
#| warning: false
#| fig-width: 14
#| fig-height: 10

analysis_data <- dbGetQuery(con, "
  WITH taxi_metrics AS (
    SELECT 
      HOUR(tpep_pickup_datetime) AS hour,
      pickup_borough,
      AVG(epoch(tpep_dropoff_datetime) - epoch(tpep_pickup_datetime)) / 60 AS avg_duration_min,
      COUNT(*) AS trip_count
    FROM taxi_enriched
    WHERE 
      pickup_borough IN ('Manhattan', 'Brooklyn', 'Queens', 'Bronx')
      AND (epoch(tpep_dropoff_datetime) - epoch(tpep_pickup_datetime)) / 60 < 120
      AND (epoch(tpep_dropoff_datetime) - epoch(tpep_pickup_datetime)) > 0
    GROUP BY 1, 2
  ),
  crash_metrics AS (
    SELECT
      HOUR(crash_time) AS hour,
      UPPER(borough) AS upper_borough,
      COUNT(*) AS crash_count
    FROM crash_data
    WHERE 
      borough IS NOT NULL
      AND crash_time IS NOT NULL
    GROUP BY 1, 2
  )
  SELECT 
    t.hour,
    t.pickup_borough,
    t.avg_duration_min,
    t.trip_count,
    COALESCE(c.crash_count, 0) AS crash_count
  FROM taxi_metrics t
  LEFT JOIN crash_metrics c
    ON t.hour = c.hour AND UPPER(t.pickup_borough) = c.upper_borough
")


correlations <- analysis_data |>
  group_by(pickup_borough) |>
  summarise(
    correlation = cor(crash_count, avg_duration_min, use = "complete.obs"),
    .groups = "drop"
  )

ggplot(analysis_data, aes(x = crash_count, y = avg_duration_min)) +
  geom_point(aes(color = pickup_borough, size = trip_count), alpha = 0.6) +
  geom_smooth(
    method = "lm",
    se = TRUE,
    color = "black",
    linewidth = 1.2,
    formula = y ~ x
  ) +
  facet_wrap(~ pickup_borough, scales = "free", ncol = 2) +
  scale_color_viridis_d(option = "turbo", end = 0.9) +
  scale_size_continuous(
    name = "–û–±—Å—è–≥ –ø–æ—ó–∑–¥–æ–∫",
    labels = label_comma(),
    range = c(2, 10)
  ) +
  scale_x_continuous(
    name = "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∞–≤–∞—Ä—ñ–π –∑–∞ –≥–æ–¥–∏–Ω—É",
    labels = label_comma()
  ) +
  scale_y_continuous(
    name = "–°–µ—Ä–µ–¥–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ—ó–∑–¥–∫–∏ —Ç–∞–∫—Å—ñ (—Ö–≤–∏–ª–∏–Ω–∏)"
  ) +
  labs(
    title = "–ó–≤'—è–∑–æ–∫ –∑–∞—Ç–æ—Ä–∏-–∞–≤–∞—Ä—ñ—ó: —á–∏ –±—ñ–ª—å—à–µ –∞–≤–∞—Ä—ñ–π –æ–∑–Ω–∞—á–∞—î –¥–æ–≤—à—ñ –ø–æ—ó–∑–¥–∫–∏?",
    subtitle = "–ê–Ω–∞–ª—ñ–∑ –∑–∞ –≥–æ–¥–∏–Ω–æ—é —Ç–∞ –±–æ—Ä–æ (—Å—ñ—á–µ–Ω—å-–ª—é—Ç–∏–π 2023) | –ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è —Å–≤—ñ–¥—á–∏—Ç—å, —â–æ –∞–≤–∞—Ä—ñ—ó –ø–æ—Å–∏–ª—é—é—Ç—å –∑–∞—Ç–æ—Ä–∏",
    caption = "–î–∞–Ω—ñ: NYC TLC + NYPD | –†–æ–∑–º—ñ—Ä —Ç–æ—á–∫–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –æ–±—Å—è–≥ –ø–æ—ó–∑–¥–æ–∫ | –õ—ñ–Ω—ñ—è –ø–æ–∫–∞–∑—É—î –ª—ñ–Ω—ñ–π–Ω–∏–π —Ç—Ä–µ–Ω–¥"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 13, color = "gray30"),
    legend.position = "right",
    strip.text = element_text(face = "bold", size = 14),
    panel.grid.minor = element_blank()
  )


knitr::kable(
  correlations,
  digits = 3,
  col.names = c("–ë–æ—Ä–æ", "–ö–æ—Ä–µ–ª—è—Ü—ñ—è (–∞–≤–∞—Ä—ñ—ó vs —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å)"),
  caption = "–ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∞–≤–∞—Ä—ñ–π —Ç–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é –ø–æ—ó–∑–¥–æ–∫ –∑–∞ –±–æ—Ä–æ"
)
```

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è:**

- **–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è**: –±—ñ–ª—å—à–µ –∞–≤–∞—Ä—ñ–π ‚Üí –¥–æ–≤—à—ñ –ø–æ—ó–∑–¥–∫–∏ —É –≤—Å—ñ—Ö –±–æ—Ä–æ
- **–ù–∞–π—Å–∏–ª—å–Ω—ñ—à–∞ –≤ –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω—ñ** (r ~ 0.6-0.7): —â—ñ–ª—å–Ω–∏–π —Ä—É—Ö –æ–∑–Ω–∞—á–∞—î, —â–æ –∞–≤–∞—Ä—ñ—ó —Å–ø—Ä–∏—á–∏–Ω—è—é—Ç—å —Å–µ—Ä–π–æ–∑–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏
- **–ü–æ–º—ñ—Ä–Ω–∞ —É –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±–æ—Ä–æ** (r ~ 0.3-0.5): –º–µ–Ω—à –≤–∑–∞—î–º–æ–ø–æ–≤'—è–∑–∞–Ω—ñ –¥–æ—Ä–æ–∂–Ω—ñ –º–µ—Ä–µ–∂—ñ
- **–ü–∏—Ç–∞–Ω–Ω—è –ø—Ä–∏—á–∏–Ω–Ω–æ—Å—Ç—ñ**: —á–∏ –∞–≤–∞—Ä—ñ—ó —Å–ø—Ä–∏—á–∏–Ω—è—é—Ç—å –∑–∞—Ç–æ—Ä–∏, —á–∏ –∑–∞—Ç–æ—Ä–∏ —Å–ø—Ä–∏—á–∏–Ω—è—é—Ç—å –∞–≤–∞—Ä—ñ—ó? –ô–º–æ–≤—ñ—Ä–Ω–æ, –¥–≤–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ.

**–ù–∞—Å–ª—ñ–¥–æ–∫:** –®–≤–∏–¥–∫–µ —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞ –∞–≤–∞—Ä—ñ—ó (–µ–≤–∞–∫—É–∞—Ç–æ—Ä–∏, —à–≤–∏–¥–∫–∞ –¥–æ–ø–æ–º–æ–≥–∞) –º–æ–∂–µ –∑–º–µ–Ω—à–∏—Ç–∏ –≤—Ç–æ—Ä–∏–Ω–Ω—ñ –∑–∞—Ç–æ—Ä–∏ —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º –∞–≤–∞—Ä—ñ—è–º.

---

## 8. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

–ù–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ —á–æ—Ç–∏—Ä–∏ –≤—Ç—Ä—É—á–∞–Ω–Ω—è, –∑–∞—Å–Ω–æ–≤–∞–Ω—ñ –Ω–∞ –¥–∞–Ω–∏—Ö:

### 1. –¶—ñ–ª—å–æ–≤–µ –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è —É –≥–æ–¥–∏–Ω–∏ –ø—ñ–¥–≤–∏—â–µ–Ω–æ—ó –Ω–µ–±–µ–∑–ø–µ–∫–∏

**–î–æ–∫–∞–∑–∏:** –ø'—è—Ç–Ω–∏—Ü—è-—Å—É–±–æ—Ç–∞ –≤–≤–µ—á–µ—Ä—ñ (17-20 –≥–æ–¥) –ø–æ–∫–∞–∑—É—é—Ç—å –Ω–∞ 40% –≤–∏—â—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞–≤–∞—Ä—ñ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –¥–æ—Ä–æ–∂–Ω—å–æ—ó –ø–æ–ª—ñ—Ü—ñ—ó –Ω–∞ –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è—Ö –∑ –≤–∏—Å–æ–∫–∏–º –æ–±—Å—è–≥–æ–º —Ä—É—Ö—É –≤ —Ü—ñ –≥–æ–¥–∏–Ω–∏
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏—Ö –ø—É–Ω–∫—Ç—ñ–≤ –Ω–∞ –≤–æ–¥—ñ–Ω–Ω—è —É —Å—Ç–∞–Ω—ñ –∞–ª–∫–æ–≥–æ–ª—å–Ω–æ–≥–æ —Å–ø'—è–Ω—ñ–Ω–Ω—è —É –ø'—è—Ç–Ω–∏—Ü—é-—Å—É–±–æ—Ç—É –≤–≤–µ—á–µ—Ä—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–∞–º–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—é —à–≤–∏–¥–∫–æ—Å—Ç—ñ —É –ø—ñ–∫–æ–≤—ñ —á–∞—Å–∏

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–ø–ª–∏–≤:** –∑–º–µ–Ω—à–µ–Ω–Ω—è –≤–µ—á—ñ—Ä–Ω—ñ—Ö –∞–≤–∞—Ä—ñ–π –Ω–∞ 10-20%

---

### 2. –ö–∞–º–ø–∞–Ω—ñ—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –æ–±—ñ–∑–Ω–∞–Ω–æ—Å—Ç—ñ –ø—Ä–æ –≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è –≤–æ–¥—ñ—ó–≤

**–î–æ–∫–∞–∑–∏:** –Ω–µ—É–≤–∞–∂–Ω—ñ—Å—Ç—å –≤–æ–¥—ñ—è —Å–ø—Ä–∏—á–∏–Ω—è—î 30% –∞–≤–∞—Ä—ñ–π –∑ —Ç—Ä–∞–≤–º–∞–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –ó–∞–≥–∞–ª—å–Ω–æ–º—ñ—Å—å–∫–∞ –∫–∞–º–ø–∞–Ω—ñ—è "–ü—Ä–∏–±–µ—Ä–∏ —Ç–µ–ª–µ—Ñ–æ–Ω"
- –¶–∏—Ñ—Ä–æ–≤—ñ –±—ñ–ª–±–æ—Ä–¥–∏ –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é –∞–≤–∞—Ä—ñ–π —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- –ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ –∑ –∫–æ–º–ø–∞–Ω—ñ—è–º–∏ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω—å –¥–ª—è –ø–æ–∫–∞–∑—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—Ä–æ –±–µ–∑–ø–µ–∫—É –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö
- –û—Å–≤—ñ—Ç–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ —É —à–∫–æ–ª–∞—Ö

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–ø–ª–∏–≤:** –∑–º–µ–Ω—à–µ–Ω–Ω—è –∞–≤–∞—Ä—ñ–π, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è–º, –Ω–∞ 5-15% –ø—Ä–æ—Ç—è–≥–æ–º 2 —Ä–æ–∫—ñ–≤

---

### 3. –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —É —Ç–æ—á–∫–∞—Ö –∞–≤–∞—Ä—ñ–π

**–î–æ–∫–∞–∑–∏:** –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—Ä–æ—ó–∑–¥ (2-–≥–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∞ –ø—Ä–∏—á–∏–Ω–∞) —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –ø—Ä–æ–±–ª–µ–º–∏ –¥–∏–∑–∞–π–Ω—É –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ–ø-100 –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑
- –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è:
  - –í–∏–ø–µ—Ä–µ–¥–∂—É—é—á–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ –¥–ª—è –ø—ñ—à–æ—Ö–æ–¥—ñ–≤ (–ø—ñ—à–æ—Ö–æ–¥–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –∑–µ–ª–µ–Ω–µ —Å–≤—ñ—Ç–ª–æ –ø–µ—Ä—à–∏–º–∏)
  - –î–µ–Ω–Ω–æ–≥–æ –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è (—á—ñ—Ç–∫—ñ –ª—ñ–Ω—ñ—ó –≤–∏–¥–∏–º–æ—Å—Ç—ñ –Ω–∞ –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è—Ö)
  - –ó–∞—Ö–∏—â–µ–Ω–∏—Ö –≤–µ–ª–æ–¥–æ—Ä—ñ–∂–æ–∫

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–ø–ª–∏–≤:** –∑–º–µ–Ω—à–µ–Ω–Ω—è –∞–≤–∞—Ä—ñ–π –Ω–∞ 20-30% —É –æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö –ª–æ–∫–∞—Ü—ñ—è—Ö

---

### 4. C–∏—Å—Ç–µ–º–∞ —à–≤–∏–¥–∫–æ–≥–æ —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏

**–î–æ–∫–∞–∑–∏:** –∞–≤–∞—Ä—ñ—ó –∑–±—ñ–ª—å—à—É—é—Ç—å –∑–∞—Ç–æ—Ä–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ç–æ—Ä–∏–Ω–Ω–∏—Ö –∞–≤–∞—Ä—ñ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏ —à–≤–∏–¥–∫–æ–≥–æ –µ–≤–∞–∫—É—é–≤–∞–Ω–Ω—è
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫–æ–º —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ –∑–Ω–∞–∫–∏
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è NYPD, DOT —Ç–∞ —Å–ª—É–∂–±–∏ —à–≤–∏–¥–∫–æ—ó –¥–æ–ø–æ–º–æ–≥–∏
- –ú–æ–±—ñ–ª—å–Ω—ñ –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∏ –∑ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏ –ø—Ä–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–ø–ª–∏–≤:** –∑–º–µ–Ω—à–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–æ–∫, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö —ñ–∑ –∑–∞—Ç–æ—Ä–∞–º–∏, –Ω–∞ 15%

---

## 9. –û–±–º–µ–∂–µ–Ω–Ω—è —Ç–∞ –º–∞–π–±—É—Ç–Ω—è —Ä–æ–±–æ—Ç–∞

### –û–±–º–µ–∂–µ–Ω–Ω—è

1. **–ß–∞—Å–æ–≤—ñ —Ä–∞–º–∫–∏**: –ª–∏—à–µ 2 –º—ñ—Å—è—Ü—ñ –¥–∞–Ω–∏—Ö —Ç–∞–∫—Å—ñ (—Å—ñ—á–µ–Ω—å-–ª—é—Ç–∏–π 2023); —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å –Ω–µ –æ—Ö–æ–ø–ª–µ–Ω–∞, –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª –Ω–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è –∑–≤—ñ—Ç–Ω—ñ—Å—Ç—å –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó**: –Ω–µ –≤—Å—ñ –∞–≤–∞—Ä—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª—è—é—Ç—å—Å—è –ø–æ–ª—ñ—Ü—ñ—ó
3. **–ü—Ä–æ–∫—Å—ñ –∑–∞—Ç–æ—Ä—ñ–≤**: —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ —î –Ω–µ–ø—Ä—è–º–∏–º –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º; –ø—Ä—è–º—ñ –¥–∞–Ω—ñ –ø—Ä–æ —Ç—Ä–∞—Ñ—ñ–∫ –±—É–ª–∏ –± –∫—Ä–∞—â–∏–º–∏
4. **–ü—Ä–∏—á–∏–Ω–Ω—ñ—Å—Ç—å**: –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –Ω–µ –º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-–Ω–∞—Å–ª—ñ–¥–∫–æ–≤—ñ –∑–≤'—è–∑–∫–∏
5. **–ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–µ –æ—Ö–æ–ø–ª–µ–Ω–Ω—è**: –¥–∞–Ω—ñ –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω—ñ –Ω–∞ –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω—ñ —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –±–æ—Ä–æ
6. **–°–∫—É–¥–Ω—ñ—Å—Ç—å –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ–π**: –ø–µ—Ä–µ–¥–∞—á–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —ñ —ó—ó –æ–±—Å—è–≥ —Å–∫—É–¥–Ω—ñ—à–∏–π —á–µ—Ä–µ–∑ –±—Ä–∞–∫ —á–∞—Å—É

### –ú–∞–π–±—É—Ç–Ω—ñ –Ω–∞–ø—Ä—è–º–∫–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω—å

1. **–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä–∞–º–æ–∫**: –∞–Ω–∞–ª—ñ–∑ –ø–æ–≤–Ω–æ–≥–æ —Ä–æ–∫—É –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Å–µ–∑–æ–Ω–Ω–∏—Ö –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π
2. **–ü—Ä–æ—Å—Ç–æ—Ä–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –≥–∞—Ä—è—á–∏—Ö —Ç–æ—á–æ–∫**: –∫–∞—Ä—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—å –∑ –Ω–∞–π–≤–∏—â–∏–º–∏ –ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏ –∞–≤–∞—Ä—ñ–π
3. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –ø–æ–≥–æ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö**: –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤–ø–ª–∏–≤—É –¥–æ—â—É, —Å–Ω—ñ–≥—É —Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –Ω–∞ –∞–≤–∞—Ä—ñ—ó
4. **–ê–Ω–∞–ª—ñ–∑ —Ç–∏–ø—ñ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤**: –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π –¥–ª—è –ª–µ–≥–∫–æ–≤–∏—Ö –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤, –≤–∞–Ω—Ç–∞–∂—ñ–≤–æ–∫, –∞–≤—Ç–æ–±—É—Å—ñ–≤, –≤–µ–ª–æ—Å–∏–ø–µ–¥—ñ–≤
5. **–ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è —Ç—è–∂–∫–æ—Å—Ç—ñ**: –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ —Ç—Ä–∞–≤–º/—Å–º–µ—Ä—Ç–µ–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∞–≤–∞—Ä—ñ–π
6. **–ï–∫–æ–Ω–æ–º—ñ—á–Ω–∏–π –≤–ø–ª–∏–≤**: –æ—Ü—ñ–Ω–∫–∞ –≤–∏—Ç—Ä–∞—Ç –Ω–∞ –∑–∞—Ç–æ—Ä–∏ —Ç–∞ –∞–≤–∞—Ä—ñ—ó –¥–ª—è –º—ñ—Å—Ç–∞
7. **–í—Ç—Ä—É—á–∞–ª—å–Ω—ñ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è**: –æ—Ü—ñ–Ω–∫–∞ –≤–ø–ª–∏–≤—É –Ω–æ–≤–∏—Ö –ø–æ–ª—ñ—Ç–∏–∫ –Ω–∞ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞–≤–∞—Ä—ñ–π

---

## 10. –í–∏—Å–Ω–æ–≤–∫–∏

–¶–µ–π –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö –ø—Ä–æ –±–µ–∑–ø–µ–∫—É –¥–æ—Ä–æ–∂–Ω—å–æ–≥–æ —Ä—É—Ö—É –≤ –ù—å—é-–ô–æ—Ä–∫—É —Ä–æ–∑–∫—Ä–∏–≤ –∫—ñ–ª—å–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç–µ–π:

**–ß–∞—Å–æ–≤—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ**: –í–µ—á–æ—Ä–∏ –ø'—è—Ç–Ω–∏—Ü—ñ-—Å—É–±–æ—Ç–∏ —î –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–º–∏, –∑ –ø—ñ–∫–∞–º–∏ –∞–≤–∞—Ä—ñ–π–Ω–æ—Å—Ç—ñ –º—ñ–∂ 17:00 —Ç–∞ 20:00. –¶–µ —á–∞—Å, –∫–æ–ª–∏ –æ–±'—î–¥–Ω—É—é—Ç—å—Å—è –≤–∏—Å–æ–∫–∏–π –æ–±—Å—è–≥ —Ç—Ä–∞—Ñ—ñ–∫—É, –≤—Ç–æ–º–∞ –ø—ñ—Å–ª—è —Ä–æ–±–æ—Ç–∏ —Ç–∞ –ø–æ—á–∞—Ç–æ–∫ –≤–∏—Ö—ñ–¥–Ω–∏—Ö.

**–ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –¥–∏—Å–ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó**: –•–æ—á–∞ –ë—Ä—É–∫–ª—ñ–Ω –º–∞—î –Ω–∞–π–≤–∏—â—É –∞–±—Å–æ–ª—é—Ç–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–≤–∞—Ä—ñ–π, –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω –ø–æ–∫–∞–∑—É—î –Ω–∞–π—Å–∏–ª—å–Ω—ñ—à—ñ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –º—ñ–∂ –∑–∞—Ç–æ—Ä–∞–º–∏ —Ç–∞ –∞–≤–∞—Ä—ñ—è–º–∏ —á–µ—Ä–µ–∑ —Å–≤–æ—é —â—ñ–ª—å–Ω—É –¥–æ—Ä–æ–∂–Ω—é –º–µ—Ä–µ–∂—É.

**–ü–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤–æ–¥—ñ—ó–≤ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è**: –í—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è –≤–æ–¥—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ 30% –∞–≤–∞—Ä—ñ–π –∑ —Ç—Ä–∞–≤–º–∞–º–∏ ‚Äî —Ü–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞, –Ω–∞ —è–∫—É –º–æ–∂–Ω–∞ –≤–ø–ª–∏–Ω—É—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–æ–∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –æ—Å–≤—ñ—Ç—É.

**–ó–∞—Ç–æ—Ä–∏ —Ç–∞ –±–µ–∑–ø–µ–∫–∞ –≤–∑–∞—î–º–æ–ø–æ–≤'—è–∑–∞–Ω—ñ**: –ù–∞—à –∞–Ω–∞–ª—ñ–∑ –ø–æ–∫–∞–∑—É—î, —â–æ –∞–≤–∞—Ä—ñ—ó —Ç–∞ –∑–∞—Ç–æ—Ä–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å –ø–µ—Ç–ª—é –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É ‚Äî –±—ñ–ª—å—à–µ –∞–≤–∞—Ä—ñ–π –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –±—ñ–ª—å—à–∏—Ö –∑–∞—Ç–æ—Ä—ñ–≤, —â–æ –º–æ–∂–µ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ä–∏–∑–∏–∫ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∞–≤–∞—Ä—ñ–π.

### –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

–î–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ü–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π NYC DOT —Ç–∞ NYPD –ø–æ–≤–∏–Ω–Ω—ñ:

1. **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏**: —Ñ–æ–∫—É—Å—É–≤–∞—Ç–∏—Å—è –Ω–∞ –ø'—è—Ç–Ω–∏—Ü—é-—Å—É–±–æ—Ç—É –≤–≤–µ—á–µ—Ä—ñ —Ç–∞ —Ç–æ—á–∫–∞—Ö –∞–≤–∞—Ä—ñ–π –∑ –≤–∏—Å–æ–∫–æ—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—î—é
2. **–í–∏–º—ñ—Ä—è—Ç–∏ –≤–ø–ª–∏–≤**: –∑–±–∏—Ä–∞—Ç–∏ –±–∞–∑–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞–≤–∞—Ä—ñ–π–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ–¥ –≤—Ç—Ä—É—á–∞–Ω–Ω—è–º–∏
3. **–ü–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏**: –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
4. **–°–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏**: –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏–º–∏ –∫–æ–º–ø–∞–Ω—ñ—è–º–∏, –º—ñ—Å—Ü–µ–≤–∏–º–∏ –≥—Ä–æ–º–∞–¥–∞–º–∏ —Ç–∞ –æ—Å–≤—ñ—Ç–Ω—ñ–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∞–º–∏

–î–∞–Ω—ñ —á—ñ—Ç–∫—ñ: –º–∏ –∑–Ω–∞—î–º–æ, **–∫–æ–ª–∏, –¥–µ —ñ —á–æ–º—É** –∞–≤–∞—Ä—ñ—ó —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è –≤ –ù—å—é-–ô–æ—Ä–∫—É. –¢–µ–ø–µ—Ä —á–∞—Å –¥—ñ—è—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ü–∏—Ö –∑–Ω–∞–Ω—å –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω—ñ—à–∏—Ö –≤—É–ª–∏—Ü—å –¥–ª—è –≤—Å—ñ—Ö.

---

## –¢–µ—Ö–Ω—ñ—á–Ω–∞ –ø—Ä–∏–º—ñ—Ç–∫–∞

**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏:**
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: DuckDB –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –≤–µ–ª–∏–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤ Parquet
- **–ú–æ–≤–∞**: R –∑ tidyverse –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö
- **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è**: ggplot2 –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–º–∏ —Ç–µ–º–∞–º–∏ —Ç–∞ –∫–æ–ª—ñ—Ä–Ω–∏–º–∏ —Å—Ö–µ–º–∞–º–∏
- **–ü—Ä–æ—Å—Ç–æ—Ä–æ–≤—ñ –¥–∞–Ω—ñ**: –ø–∞–∫–µ—Ç sf –¥–ª—è –æ–±—Ä–æ–±–∫–∏ GeoJSON —Ç–∞ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É
- **–†–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏**: –ø–æ–≤–Ω–∏–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö (12M+ –ø–æ—ó–∑–¥–æ–∫ —Ç–∞–∫—Å—ñ, 2M+ –∞–≤–∞—Ä—ñ–π)

**–í—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å:**
–í–µ—Å—å –∫–æ–¥ –Ω–∞–¥–∞–Ω–æ –≤ —Ü—å–æ–º—É Quarto-–¥–æ–∫—É–º–µ–Ω—Ç—ñ. –î–ª—è –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ Yellow Taxi 2023 (—Å—ñ—á–µ–Ω—å-–ª—é—Ç–∏–π) –∑ NYC TLC
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ taxi_zones.geojson –∑ NYC TLC
3. –†–æ–∑–º—ñ—Å—Ç—ñ—Ç—å —É –ø–∞–ø—Ü—ñ `./data/`
4. –í—ñ–¥—Ä–µ–Ω–¥–µ—Ä—ñ—Ç—å —Ü–µ–π .qmd —Ñ–∞–π–ª –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `quarto render` –≤–∫–∞–∑–∞–≤—à–∏ –í–ê–® —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É –∑–∞–º—ñ–Ω–∏–≤—à–∏ `\` –Ω–∞ "//"

---

## –î–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö:

- [NYC Taxi & Limousine Commission (TLC)](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page)
- [NYC Open Data Portal](https://opendata.cityofnewyork.us/)
- [NYPD Motor Vehicle Collision Reports](https://www.nyc.gov/site/nypd/services/vehicles-property/reports.page)

---
## –ö—ñ–Ω—Ü—ñ–≤–∫–∞

```{r cleanup}
dbDisconnect(con, shutdown = TRUE)
cat("–ó'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö –∑–∞–∫—Ä–∏—Ç–æ")
```